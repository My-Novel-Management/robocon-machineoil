# -*- coding: utf-8 -*-
"""Episode: 1.殺人事件
"""
## path
import os
import sys
sys.path.append(os.path.join(os.path.dirname(__file__), '../..'))
sys.path.append('storybuilder')
## local libs
from storybuilder.builder.world import World
from storybuilder.builder.writer import Writer


## define alias
W = Writer
_ = W.getWho()


## scenes
def sc_tobira(w: World):
    adam = W(w.adam)
    return w.scene("アシモフのロボット工学三原則",
            w.comment("扉は冒頭に別枠で作る"),
            adam.be(),
            adam.explain("第一条　ロボットは人間に危害を加えてはならない。また、その危険を看過することによって、人間に危害を及ぼしてはならない"),
            _.explain("第二条　ロボットは人間にあたえられた命令に服従しなければならない。ただし、あたえられた命令が、第一条に反する場合は、この限りでない"),
            _.explain("第三条　ロボットは、前掲第一条および第二条に反するおそれのないかぎり、自己をまもらなければならない"),
            _.explain("――アイザック・アシモフ『われはロボット』小尾芙佐訳、早川書房　より"),
            camera=w.emilia,
            stage=w.on_herroom,
            day=w.in_reporting, time=w.at_afternoon,
            )

def sc_report_introduction(w: World):
    emil, adam, paul = W(w.emilia), W(w.adam), W(w.paul)
    return w.scene("レポート序文",
            w.comment("$emiliaのレポートという形式の三人称で", "扉と同じページに作る"),
            w.symbol("　　　　※"),
            emil.be("#ホテルの部屋でレポートを書いている"),
            emil.think("ロボットというものについて考える時、$meはいつも彼のことを思い出す",
                "彼と呼ぶことが正しいかどうかはこのレポートを最後まで読んでもらい、各自判断してもらいたいと思う"),
            emil.think("ロボットとは何なのかということについて、未だに評議会では結論が出ていない",
                "かつては単なる人間の労働の代行者でしかなかった彼らが、知能を手に入れ、人間の姿を手に入れ、",
                "徐々に人間の生活を支えるのに必須の存在になってからも、",
                "そこには漫然としたロボットと人間の境界線というものは存在していたように感じている"),
            emil.think("シンギュラリティは来なかった",
                "未だに人間は人間で、ロボットはロボットだ",
                "と評価するのはまだ早いと考えている"),
            emil.think("事実、ロボットの自発的と考えられる反乱事件が相次ぎ、今日までにその関連死は一万人を超えているという集計もある"),
            emil.think("しかし$meは思うのだ",
                "ロボットと人間を分けているものは一体何なのだろうかと"),
            emil.do("レポートを書く手を止め、$Sは機械油みたいにどす黒いコーヒーを口に注ぎ込んだ"),
            w.comment("何かしら結末と全体の流れを暗示するものを"),
            stage=w.on_herroom_int,
            day=w.in_reporting, time=w.at_midmorning,
            )

def sc_interview(w: World):
    emil, adam, paul, uru = W(w.emilia), W(w.adam), W(w.paul), W(w.uru)
    inside, outside = W(w.inside), W(w.outside)
    return w.scene("取材",
            emil.come(),
            uru.be("#案内している"),
            inside.look("天井は薄暗い", "ライトも監視カメラも確認できない"),
            emil.do("足元を見る"),
            inside.look("のっぺりとしたコーティングがされたベージュの床",
                "それが足元の間接照明でオレンジに照らされる"),
            emil.do("$Sのヒールの低いパンプスの音は小さくしか響かない"),
            inside.look("施設の通路内装",
                "窓がなく、明るさも足元を間接照明が照らすだけ"),
            emil.talk("暗いんですね"),
            emil.do("社員の$uruの後に続いて、その通路を歩いていく"),
            uru.look("社員の制服",
                "背中に大きく$w_cias社のマークがある",
                "革靴は黒光りしている",
                "両腕の手首に太いバンドがされていて、それが簡易端末になっているらしい"),
            uru.look("濃い金色の髪がぴったりとなでつけられている",
                "さながら毛一本落とさないようにコーティングしているみたいだ"),
            uru.talk("彼らはセンサーで感知しますので、人間のように視覚的な補助は必要としません",
                "しかし今は施設訪問者用のモードに切り替えているので、人間が歩く場所は明るくなるように設定しています"),
            inside.look("光が移り変わっていく"),
            emil.do("歩いていくといきなり直立不動の人間が現れる",
                "よく見ればロボットで、グリーンの全身タイツみたいな格好に顔のついた目がぎょろりと見ている",
                "彼は何も言わずに見送ってから歩いていってしまう",
                "歩行音が重い",
                "そのややぎこちない歩行を見て、ロボットだと認識する"),
            uru.talk("驚かれましたか、$emiliaさん"),
            emil.talk("いくつか取材で回らせてもらっているのですが、ここまで徹底している施設は初めてなもので", "驚きました"),
            inside.look("$w_cias社のマークがプレートに見つかる",
                "マークは眼鏡を模ったもの"),
            w.comment("眼鏡はアシモフの肖像画から"),
            emil.look("ズボンの上に短いスカート、上着はスーツ",
                "現代風だが、小物は未来感を"),
            emil.talk("本日はありがとうございます",
                "まさか取材を受けてもらえるとは"),
            uru.talk("$on_RobertComの方と聞いていたので、あなたのような若い女性が来られて驚きました"),
            emil.talk("年齢や性別は重視されず、知識と取材技術によって決められています",
                "うちでも$w_cias社のシステムを一部利用しているんですよ"),
            uru.talk("それはありがとうございます"),
            uru.talk("我々も世界に売り出すことを踏まえてオープンにしていこうということです"),
            emil.do("今まで決して取材等、外部の人間を入れなかった$w_cias社だったが、",
                "どういう方針転換だろうと疑っていた"),
            emil.talk("こちらではロボットではなく$w_droidと呼べば宜しいでしょうか"),
            uru.talk("それは助かります",
                "$meたちもいつも外部の人間が彼らをロボットと言うことに違和感があったのです",
                "彼らは$meたちの製品であり、ロボットと一般に呼称されるそれとは異なると考えているからです"),
            emil.talk("一番の違いは何でしょう"),
            uru.talk("ロボットは旧世紀の、人間に役立つ奴隷を目指して造られたものであり、",
                "$w_droidは人間が生活を円滑に送るための新しい家電や装置、だということでしょうか",
                "だから我が社のものは必ず人間型を模している訳ではありません",
                "ここもそのテストケースと思って下さって結構です"),
            emil.do("キャタピラのついた運搬機が何かを運んでいく"),
            emil.talk("ああいったものも全て$w_droidなんですか？"),
            uru.talk("そういうことになります"),
            w.eventPoint("$w_cias", "今まで外部の人間を決して入れなかった"),
            emil.do("通路を歩いていると、そこかしこで、作業用$w_droidが作業をしている姿を見かける",
                "どれも$w_cias社のマークがある"),
            inside.look("闇の中から突然$w_droidが現れたみたいに"),
            emil.do("驚くが、彼らはカメラだけを向けて、通り過ぎる"),
            emil.talk("ここには何人の人間がいるんですか？"),
            uru.talk("基本的に人間はいません",
                "人間は別の場所から遠隔で管理を行っているだけです"),
            emil.talk("それじゃあたとえば何か異常が発生した時には？"),
            w.eventPoint("ロボットの運用", "遠隔操作でシャットダウンできる"),
            uru.talk("個別にシャットダウンすることもできますし、",
                "施設そのものの電源を落とすことも可能です",
                "$w_droidたちも設備も、すべて電源が必要なので、それで一旦停止しますから、",
                "それから分析を行えばいいだけです"),
            uru.talk("つまり、他社のものと違い、",
                "我々の$w_droidは完全に自律し、人間の手を借りなくてもいいということです"),
            w.comment("ここで$w_droidの説明をする"),
            uru.talk("ではこちらへどうぞ"),
            emil.do("$uruに案内され、作業場に"),
            emil.do("エレベータに乗り込み、地下へと降りる",
                    "建物全体は地上二階、地下五階という構造になっていた"),
            stage=w.on_pathway,
            day=w.in_visit, time=w.at_afternoon,
            )

def sc_droidjob(w: World):
    emil, adam, paul, uru = W(w.emilia), W(w.adam), W(w.paul), W(w.uru)
    inside, outside = W(w.inside), W(w.outside)
    return w.scene("$w_droidたちの仕事",
            w.eventPoint("$w_droidについて", "$w_droidの仕事"),
            emil.come("#解体作業ホールにやってくる"),
            uru.come(),
            adam.be("#作業している"),
            inside.look("解体作業ホール",
                "大きな空間に沢山の$w_droidがいる",
                "一番奥には巨大な破砕機があり、そこにベルトコンベアで流し込まれる様々なゴミが、",
                "次々に砕かれていく"),
            inside.look("その大きな音が響いていた"),
            emil.talk("ここがこの施設の中心部ですね？"),
            uru.talk("はい", "まずここで全て細かく砕き、それを素材ごとに分別して、",
                "その先は別々の施設にまとめて配送します",
                "ここは解体がメインなので、搬入されたゴミをとにかく解体し、綺麗に分けて、",
                "再利用へと回します"),
            inside.look("壁の一面が沢山のブレード付き歯車が回転して、そこにベルトコンベアに乗った様々なものが吸い込まれ、",
                "砕かれてすごい音を発している"),
            emil.do("メモ帳を出して構えている"),
            uru.talk("珍しく今どき手書きなんですね"),
            emil.talk("最後のところでデジタルデバイスは信用できないもので"),
            uru.talk("半世紀前にはそういった人も沢山いましたが、今は希少種でしょう"),
            emil.do("インタビューは続く"),
            adam.do("ゴミを解体し、必要なものとそうでないものに分別して、破砕機に送る"),
            inside.look("沢山の$w_droidが並ぶ"),
            emil.do("それを上にあるハッチから見ている"),
            emil.do("$uruから説明を受ける"),
            uru.talk("こちらで彼らは一日十二時間、二交代で働き続けます"),
            emil.talk("半分で交代ですか？"),
            uru.talk("ええ", "多くの方はロボットであれば二十四時間使い続けても大丈夫と考えますが、",
                "機械部品は消耗品です",
                "稼働時間にともない劣化し、壊れます",
                "その耐久時間を考えて、今十二時間稼働にしています"),
            adam.look("一体だけボディのカラーリングが異なるものがある"),
            adam.look("他はグリーン系のボディペイントだが、",
                "それは右肩から胸元にかけて僅かな部分が濃いオレンジになっている"),
            emil.talk("あれは何か特別な役割を？"),
            uru.talk("おそらく修繕の過程で色がなかったのでしょう",
                "ここの$w_droidは全て同じです",
                "人間のように上司と部下の関係は必要ありません",
                "状況に応じて、それぞれが役割をこなすだけです"),
            emil.do("部屋の隅に火花がいくつか飛ぶ",
                "そこで折れた腕を修復しているのが見て分かった"),
            w.comment("ロボットについて、基本性能などを書いておく"),
            uru.talk("ロボットには人間社会の倫理は必要ないんですよ",
                "だから本来は人間そっくりに作る必要なんてないのですが、",
                "社会の様々なものが人間に適用する作られているから、",
                "結果として人型をしている方が都合がよくなるんです"),
            emil.think("一般社会で働くロボットたちを思い起こす"),
            w.eventPoint("$w_droidについて", "$w_droidの死"),
            emil.do("その中の一体が、突然動かなくなる"),
            uru.talk("ああやって突然故障するのもロボットの特徴です",
                "人間のように徐々に悪くなる、といったことがほとんどありません"),
            uru.do("端末で連絡し、回収$w_droidを呼ぶ"),
            emil.do("回収されていくのを見ている"),
            emil.talk("壊れたものを回収するのも全て$w_droidが？"),
            uru.talk("ええ、そうです", "だからここには人間は必要ないんです"),
            adam.do("そのうちの一体が、一瞬運ばれていく仲間を見ていた",
                "だが後続に押されて作業に戻る"),
            camera=w.adam,
            stage=w.on_dismantlinghall_int,
            day=w.in_current, time=w.at_afternoon,
            )

def sc_murdercase(w: World):
    emil, adam, paul, uru = W(w.emilia), W(w.adam), W(w.paul), W(w.uru)
    inside, outside = W(w.inside), W(w.outside)
    return w.scene("殺人事件",
            emil.come(),
            uru.come(),
            emil.do("他の作業場も見せてもらった後で、最後に技師の部屋を尋ねる"),
            emil.talk("完全に$w_droidだけで運用するために人を排除しているんですか？"),
            uru.talk("当初は技術的な問題から難しかったのですが、",
                "結論としては人間の柔軟さよりも意思決定の歪み発生率による悪影響が高いと考え、",
                "一月前に踏み切りました",
                "その移行期なのでメンテナンスの為の人材はときどきやってきます",
                "ただいずれは救急車のように、彼らによって呼ばれた時のみ人間がここに入ることになるでしょう",
                "その方が合理的です"),
            uru.talk("本来ならインタビューはもっと早く受けるべきだったのですが、",
                "そういう事情もあり、なかなか踏み切れなかったのです"),
            emil.talk("月に何日かメンテナーが来るんですか"),
            uru.talk("メンテナンス用のシステムの調子が悪かったので、緊急措置ですね",
                "基本的にはメンテナンスも含めて全て$w_droidが行います",
                "それが理想であり、効率として最も良いと結果が出ていますから"),
            uru.talk("こちらが技師の部屋になります",
                "彼が技術的なことについて、より専門的なことを答えてくれるでしょう"),
            uru.do("ドアを開ける"),
            emil.talk("あれ？　いませんね"),
            inside.look("部屋はスライドドアで仕切られ、ベッドと端末の乗った机"),
            uru.talk("おかしいな", "少し記録を確認する"),
            adam.come("$Sが入ってくる"),
            emil.do("さっきのカラーリングが一部異なる$w_droidだった"),
            uru.talk("入室記録を見せてくれ"),
            adam.do("入室記録を出す"),
            uru.talk("彼らに聞けばメインサーバに問い合わせをしてくれる",
                "こうして確認ができる",
                "各所に端末もあるが、基本は彼らに尋ねると良い"),
            adam.talk("人間が部屋を出た記録はありません"),
            uru.talk("この施設の中にまだいるのか？"),
            adam.talk("この部屋から出た記録はありません",
                "まだこの部屋の中にいます"),
            uru.do("苦笑する$S"),
            emil.explain("しかしその後、$nielの体が破砕機でバラバラにされていたことが現場を確認した$uruにより報告された"),
            )

## episode
def ep_murdercase(w: World):
    return w.episode("1.殺人事件",
            sc_tobira(w),
            sc_report_introduction(w),
            sc_interview(w),
            sc_droidjob(w),
            sc_murdercase(w),
            ## NOTE
            ##  - 世界観説明
            note="人間の為に労働専用のロボット「$w_droid」たちがいた。彼らはロボット三原則に従い行動していたが、何故か殺人事件が発生してしまう。$adamは人間に近づく為、捜査協力を買って出る")


